from pathlib import Path
path = Path("src/pages/AdminMembershipPage.jsx")
text = path.read_text()
marker = "  const loadData = async () => {\n    setLoadingData(true);\n    setError(\"\");\n    try {\n      const [usersRes, plansRes] = await Promise.all([\n        fetch(`${API_BASE_URL}/api/admin/memberships/users`, {\n          headers: getAuthHeaders(),\n        }),\n        fetch(`${API_BASE_URL}/api/plans`),\n      ]);\n\n      const usersJson = await usersRes.json();\n      if (!usersRes.ok) {\n        throw new Error(usersJson.error || \"Failed to load members\");\n      }\n      const fetchedUsers = Array.isArray(usersJson.users) ? usersJson.users : [];\n      setUsers(fetchedUsers);\n      const defaults = {};\n      fetchedUsers.forEach((entry) => {\n        defaults[entry.id] = entry.plan_name || \"free\";\n      });\n      setSelectedPlans(defaults);\n\n      if (plansRes.ok) {\n        const plansJson = await plansRes.json();\n        setPlans(Array.isArray(plansJson.plans) ? plansJson.plans : []);\n      } else {\n        setPlans([]);\n      }\n\n      await loadJobCompanies();\n    } catch (err) {\n      console.error(\"Failed to load admin data\", err);\n      setError(err.message || \"Failed to load admin data\");\n    } finally {\n      setLoadingData(false);\n    }\n  };\n"
insert = "\n  const loadJobCompanies = async () => {\n    setJobLoading(true);\n    setJobError('');\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/admin/jobs/companies`, {\n        headers: getAuthHeaders(),\n      });\n      const payload = await response.json();\n      if (!response.ok) {\n        throw new Error(payload.error || 'Failed to load job companies');\n      }\n      setJobCompanies(Array.isArray(payload.companies) ? payload.companies : []);\n    } catch (err) {\n      console.error('Failed to load job companies', err);\n      setJobError(err.message || 'Failed to load job companies');\n    } finally {\n      setJobLoading(false);\n    }\n  };\n"
text = text.replace(marker, marker + insert, 1)
path.write_text(text)
